"use strict";$(function(){const select2=$('.select2-search');if(select2.length){select2.each(function(){var $this=$(this);$this.select2({placeholder:'Select Option',dropdownParent:$this.parent(),allowClear:!0,})})}
var dt_details_table=$('.datatables-order-details');var dt_product_table=$(".datatables-products");if(dt_details_table.length){var dt_products=dt_details_table.DataTable({processing:!0,serverSide:!0,ajax:{url:`${BASE_URL}Capital_share/contribution_dt_list`,type:"POST",},columns:[{data:''},{data:'due_date'},{data:'amount_due'},{data:'status'},{data:''}],columnDefs:[{className:'control',searchable:!1,orderable:!1,responsivePriority:2,targets:0,render:function(data,type,full,meta){return''}},{targets:1,orderable:!1,checkboxes:{selectAllRender:'<input type="checkbox" class="form-check-input">'},render:function(){return'<input type="checkbox" class="dt-checkboxes form-check-input" >'},searchable:!1},{targets:2,responsivePriority:1,searchable:!1,orderable:!1,render:function(data,type,full,meta){var $name=full.due_date;var $row_output='<div class="d-flex flex-column">'+'<h6 class="text-body mb-0 ">'+$name+'</h6>'+'</div>'+'</div>';return $row_output}},{targets:3,searchable:!1,orderable:!1,render:function(data,type,full,meta){var $per_share=full.amount_due;var $output='<span class="text-body">'+$per_share+'</span>';return $output}},{targets:4,searchable:!1,orderable:!1,render:function(data,type,full,meta){var $status=full.status;var $badgeClass='';if($status==='paid'){$badgeClass='badge bg-success'}else if($status==='pending'){$badgeClass='badge bg-warning '}else if($status==='Rejected'){$badgeClass='badge bg-danger'}else{$badgeClass='badge bg-secondary'}
var $output='<span class="'+$badgeClass+'">'+$status+'</span>';return $output}}],order:[2,''],dom:'t',responsive:{details:{display:$.fn.dataTable.Responsive.display.modal({header:function(row){var data=row.data();return'Details of '+data.full_name}}),type:'column',renderer:function(api,rowIdx,columns){var data=$.map(columns,function(col,i){return col.title!==''?'<tr data-dt-row="'+col.rowIndex+'" data-dt-column="'+col.columnIndex+'">'+'<td>'+col.title+':'+'</td> '+'<td>'+col.data+'</td>'+'</tr>':''}).join('');return data?$('<table class="table"/><tbody />').append(data):!1}}}})}
setTimeout(()=>{$('.dataTables_filter .form-control').removeClass('form-control-sm');$('.dataTables_length .form-select').removeClass('form-select-sm')},300);if(dt_product_table.length){var dt_products=dt_product_table.DataTable({lengthMenu:[[10,25,50,-1],[10,25,50,"All"],],processing:!0,serverSide:!0,ajax:{url:`${BASE_URL}Capital_share/payment_dt_list`,type:"POST",},columns:[{data:""},{data:"payment_date"},{data:"financial_service_provider"},{data:"status"},{data:""},],columnDefs:[{className:"control",searchable:!1,orderable:!1,responsivePriority:2,targets:0,render:function(data,type,full,meta){return""},},{targets:1,responsivePriority:1,render:function(data,type,full,meta){var $date=moment(full.payment_date).format('MMMM D, YYYY');return $date},},{targets:2,responsivePriority:3,render:function(data,type,full,meta){var $category=[full.financial_service_provider];var categoryBadgeObj={BDO:'<span class="avatar-sm rounded-circle d-flex justify-content-center align-items-center bg-label-success me-2">'+'<img src="'+"assets/img/icons/payments/BDO.png"+'" alt="icon" class="icon-img w-px-30 h-auto rounded-circle">'+"</span>",GCash:'<span class="avatar-sm rounded-circle d-flex justify-content-center align-items-center bg-label-success me-2">'+'<img src="'+"assets/img/icons/payments/GCash.png "+'" alt="icon" class="icon-img w-px-30 h-auto rounded-circle">'+"</span>",Maya:'<span class="avatar-sm rounded-circle d-flex justify-content-center align-items-center bg-label-success me-2">'+'<img src="'+"assets/img/icons/payments/maya.png"+'" alt="icon" class="icon-img w-px-30 h-auto rounded-circle">'+"</span>",over_the_counter:'<span class="avatar-sm rounded-circle d-flex justify-content-center align-items-center bg-label-success me-2">'+'<img src="'+"assets/img/icons/brands/cash-counter-logo.png"+'" alt="icon" class="icon-img w-px-30 h-auto rounded-circle">'+"</span>",};return("<span class='text-truncate d-flex align-items-center'>"+(categoryBadgeObj[$category]+$category)+"</span>")},},{targets:3,searchable:!1,orderable:!1,render:function(data,type,full,meta){var $status=full.status;var $badgeClass='';if($status==='Completed'){$badgeClass='badge bg-success'}else if($status==='pending'){$badgeClass='badge bg-warning '}else if($status==='Rejected'){$badgeClass='badge bg-danger'}else{$badgeClass='badge bg-secondary'}
var $output='<span class="'+$badgeClass+'">'+$status+'</span>';return $output}},{targets:-1,title:"Actions",searchable:!1,orderable:!1,render:function(data,type,full,meta){const or_id=full.receipt_id;const invoiceUrl=`${BASE_URL}Transaction_history/view/${or_id}"`
return('<div class="d-flex align-items-center">'+'<div class="dropdown">'+`<a href="${invoiceUrl}" data-bs-toggle="tooltip" class="btn btn-primary d-grid ml-2" style="margin-left: 2px;" data-bs-placement="top" title="Preview Invoice"><i class="bx bx-show mx-1"></i></a>`+'</div>'+'</div>')},},],order:[2,"asc"],dom:'<"card-header d-flex border-top rounded-0 flex-wrap py-md-0"'+'<"me-5 ms-n2 pe-5"f>'+'<"d-flex justify-content-start justify-content-md-end align-items-baseline"<"dt-action-buttons d-flex align-items-start align-items-md-center justify-content-sm-center mb-3 mb-sm-0"lB>>'+">t"+'<"row mx-2"'+'<"col-sm-12 col-md-6"i>'+'<"col-sm-12 col-md-6"p>'+">",lengthMenu:[7,10,20,50,70,100],language:{sLengthMenu:"_MENU_",search:"",searchPlaceholder:"Search Product",info:"Displaying _START_ to _END_ of _TOTAL_ entries",},buttons:[{extend:"collection",className:"btn btn-label-secondary dropdown-toggle me-3",text:'<i class="bx bx-export me-1"></i>Export',buttons:[{extend:"print",text:'<i class="bx bx-printer me-2" ></i>Print',className:"dropdown-item",exportOptions:{columns:[1,2,3,4,5,6,7],format:{body:function(inner,coldex,rowdex){if(inner.length<=0)return inner;var el=$.parseHTML(inner);var result="";$.each(el,function(index,item){if(item.classList!==undefined&&item.classList.contains("product-name")){result=result+item.lastChild.firstChild.textContent}else if(item.innerText===undefined){result=result+item.textContent}else result=result+item.innerText});return result},},},customize:function(win){$(win.document.body).css("color",headingColor).css("border-color",borderColor).css("background-color",bodyBg);$(win.document.body).find("table").addClass("compact").css("color","inherit").css("border-color","inherit").css("background-color","inherit")},},{extend:"csv",text:'<i class="bx bx-file me-2" ></i>Csv',className:"dropdown-item",exportOptions:{columns:[1,2,3,4,5,6,7],format:{body:function(inner,coldex,rowdex){if(inner.length<=0)return inner;var el=$.parseHTML(inner);var result="";$.each(el,function(index,item){if(item.classList!==undefined&&item.classList.contains("product-name")){result=result+item.lastChild.firstChild.textContent}else if(item.innerText===undefined){result=result+item.textContent}else result=result+item.innerText});return result},},},},{extend:"excel",text:'<i class="bx bxs-file-export me-2"></i>Excel',className:"dropdown-item",exportOptions:{columns:[1,2,3,4,5,6,7],format:{body:function(inner,coldex,rowdex){if(inner.length<=0)return inner;var el=$.parseHTML(inner);var result="";$.each(el,function(index,item){if(item.classList!==undefined&&item.classList.contains("product-name")){result=result+item.lastChild.firstChild.textContent}else if(item.innerText===undefined){result=result+item.textContent}else result=result+item.innerText});return result},},},},{extend:"pdf",text:'<i class="bx bxs-file-pdf me-2"></i>Pdf',className:"dropdown-item",exportOptions:{columns:[1,2,3,4,5,6,7],format:{body:function(inner,coldex,rowdex){if(inner.length<=0)return inner;var el=$.parseHTML(inner);var result="";$.each(el,function(index,item){if(item.classList!==undefined&&item.classList.contains("product-name")){result=result+item.lastChild.firstChild.textContent}else if(item.innerText===undefined){result=result+item.textContent}else result=result+item.innerText});return result},},},},{extend:"copy",text:'<i class="bx bx-copy me-2" ></i>Copy',className:"dropdown-item",exportOptions:{columns:[1,2,3,4,5,6,7],format:{body:function(inner,coldex,rowdex){if(inner.length<=0)return inner;var el=$.parseHTML(inner);var result="";$.each(el,function(index,item){if(item.classList!==undefined&&item.classList.contains("product-name")){result=result+item.lastChild.firstChild.textContent}else if(item.innerText===undefined){result=result+item.textContent}else result=result+item.innerText});return result},},},},],},],});$(".dataTables_length").addClass("mt-0 mt-md-3 me-3");$(".dt-buttons > .btn-group > button").removeClass("btn-secondary");$(".dt-buttons").addClass("d-flex flex-wrap")}
$(".datatables-products tbody").on("click",".delete-record",function(){dt_products.row($(this).parents("tr")).remove().draw()});setTimeout(()=>{$(".dataTables_filter .form-control").removeClass("form-control-sm");$(".dataTables_length .form-select").removeClass("form-select-sm")},300)})