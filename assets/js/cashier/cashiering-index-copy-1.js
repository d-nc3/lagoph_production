'use strict';$(function(){var table=$('.datatables-transactions');if(table.length){var dt=table.DataTable({lengthMenu:[[10,25,50,-1],[10,25,50,"All"]],processing:!0,serverSide:!0,ajax:{url:`${BASE_URL}Cashiering/dt_list`,type:"POST",data:function(d){}},columns:[{data:''},{data:'Name'},{data:'invoice_number'},{data:'date_issued'},{data:'transaction_name'},{data:'status'},],columnDefs:[{targets:0,responsivePriority:4,render:function(data,type,full,meta){var $name=full.first_name+' '+full.last_name,$email=full.email;var states=['success','danger','warning','info','dark','primary','secondary'];var $state=states[full.id%states.length],$initials=$name.match(/\b\w/g)||[];$initials=(($initials.shift()||'')+($initials.pop()||'')).toUpperCase();var $output='<span class="avatar-initial rounded-circle bg-label-'+$state+'">'+$initials+'</span>';var $row_output=`
                        <div class="d-flex justify-content-start align-items-center user-name">
                          <div class="avatar-wrapper">
                            <div class="avatar avatar-sm me-3">
                              ${$output}
                            </div>
                          </div>
                          <div class="d-flex flex-column">
                            <a href="${BASE_URL}Cashiering/view/${full['id']}" class="text-body text-truncate"><span class="fw-medium name">${$name}</span></a>
                            <small class="text-muted email">${$email}</small>
                          </div>
                        </div>
                        `;return $row_output}},{className:'control',responsivePriority:2,searchable:!1,targets:1,render:function(data,type,full,meta){var invoiceId=full.cashiering_invoice_id;var invoiceNumber=full.invoice_number;return `<a href="${BASE_URL}Cashiering/view/${invoiceId}">${invoiceNumber}</a>`}},{targets:2,render:function(data,type,full,meta){var date_issued=full.date_issued;return `<span>${date_issued}</span>`}},{targets:3,render:function(data,type,full,meta){var status=full.status;var statusColor='';switch(status){case 'payment-initiated':statusColor='badge bg-label-warning';break;case 'completed':statusColor='badge bg-label-success';break;case 'failed':statusColor='badge bg-label-danger';break;default:statusColor='badge bg-label-secondary';break}
return `<span class="${statusColor}">${status}</span>`}},{targets:4,render:function(data,type,full,meta){var invoice_type=full.transaction_name;return `<span>${invoice_type}</span>`}},{targets:-1,title:'Actions',searchable:!1,orderable:!1,render:function(data,type,full,meta){const invoiceType=full.transaction_name;const invoiceUrl=invoiceType==='membership_fee'?`${BASE_URL}Transaction/view_transaction/${full['user_id']}/${full['invoice_number']}"`:`${BASE_URL}Transaction/view_transaction/${full['user_id']}/${full['invoice_number']}"`;return('<div class="d-flex align-items-center">'+'<div class="dropdown">'+`<a href="${invoiceUrl}" data-bs-toggle="tooltip" class="btn btn-primary d-grid ml-2" style="margin-left: 2px;" data-bs-placement="top" title="Preview Invoice"><i class="bx bx-show mx-1"></i></a>`+'</div>'+'</div>')}}],order:[[0,'asc']]});$('#status-filter').on('change',function(){dt.ajax.reload()})}
$('.invoice-list-table tbody').on('click','.delete-record',function(){dt_invoice.row($(this).parents('tr')).remove().draw()});setTimeout(()=>{$('.dataTables_filter .form-control').removeClass('form-control-sm');$('.dataTables_length .form-select').removeClass('form-select-sm')},300)})