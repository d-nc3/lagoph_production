'use strict';(function(){function initializeFormValidation(form,fields){return FormValidation.formValidation(form,{fields:fields,plugins:{trigger:new FormValidation.plugins.Trigger(),bootstrap5:new FormValidation.plugins.Bootstrap5({eleValidClass:'is-valid',rowSelector:function(field,ele){return'.mb-3'}}),autoFocus:new FormValidation.plugins.AutoFocus()}})}
function handleFormSubmission(formValidationInstance,formElement,url){formValidationInstance.validate().then(function(status){if(status==='Valid'){showBlockUI();$.ajax({url:url,type:"POST",data:new FormData(formElement),contentType:!1,cache:!1,processData:!1,dataType:'json',success:function(response){hideBlockUI();if(response.status){Swal.fire({text:response.message,icon:"success",buttonsStyling:!1,confirmButtonText:"Ok, got it!",customClass:{confirmButton:"btn fw-bold btn-primary",}}).then(()=>{window.location.reload()})}else{handleErrors(response)}},error:function(){hideBlockUI();Swal.fire({text:"Sorry, looks like there are some errors detected, please try again.",icon:"error",buttonsStyling:!1,confirmButtonText:"Ok, got it!",customClass:{confirmButton:"btn btn-primary"}})}})}})}
function handleErrors(response){if(Object.keys(response.validation_errors).length>0){let html='<div class="text-start">Please check the following fields:</br>';html+='<ol>';$.each(response.validation_errors,function(key,value){html+=`<li><b>${value.label}</b> : ${value.message}</li>`});html+='</ol></div>';Swal.fire({title:response.message,icon:'error',html:html,showCloseButton:!0,focusConfirm:!0,confirmButtonText:"Ok, got it!",customClass:{confirmButton:"btn fw-bold btn-primary",},buttonsStyling:!1})}else{Swal.fire({text:response.message,icon:"error",buttonsStyling:!1,confirmButtonText:"Ok, got it!",customClass:{confirmButton:"btn btn-primary"}})}}
const agreementForm=document.getElementById('membershipAgreementForm');if(agreementForm){const formAgreement=initializeFormValidation(agreementForm,{terms_checkbox:{validators:{notEmpty:{message:'This field is required'}}}});const buttonSubmit=document.getElementById('submitAgreement');buttonSubmit.addEventListener('click',function(event){event.preventDefault();handleFormSubmission(formAgreement,agreementForm,`${BASE_URL}Invoice_membership/generate_membership_billing`)})}})()